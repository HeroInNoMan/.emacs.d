#!/usr/bin/env emacs --script

(let ((current-directory (file-name-directory load-file-name)))
  (setq espuds-test-path (expand-file-name "." current-directory))
  (setq espuds-root-path (expand-file-name ".." current-directory)))

(add-to-list 'load-path espuds-root-path)
(add-to-list 'load-path espuds-test-path)

(setq espuds-path (expand-file-name ".." espuds-test-path))
(setq espuds-fixtures-path (expand-file-name "fixtures" espuds-test-path))

(setq debug-on-entry t)
(setq debug-on-error t)

(require 'cl)
(require 'el-mock)
(require 'edmacro)
(require 'espuds-helpers)

(load (expand-file-name "test-helper.el" espuds-test-path) nil t)
(dolist (test-file (or argv (directory-files espuds-test-path t "-test.el$")))
  (load test-file nil t))

(ert-run-tests-batch t)
